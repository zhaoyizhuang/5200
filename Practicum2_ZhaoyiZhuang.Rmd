---
title: "CS5200 Practicum2"
author: "Zhaoyi Zhuang"
output: html_notebook
---

# Part 1
## Part1 Question1 
![](/Users/zhaoyizhuang/5200/Practicum2/P2Q1ERD.png)

## Create the database
```{r}
library(RSQLite)

fpath = "/Users/zhaoyizhuang/5200/Practicum2/"
dbfile = "p2DB.sqlite"

# if database file already exists, we connect to it, otherwise
# we create a new database
dbcon <- dbConnect(RSQLite::SQLite(), paste0(fpath,dbfile))
```

## Part1 Question2 Relational Schema
```{sql connection=dbcon}
PRAGMA foreign_keys = ON
```

```{sql connection=dbcon}
DROP TABLE IF EXISTS Journal
```

```{sql connection=dbcon}
CREATE TABLE Journal(
  JID Integer NOT NULL,
  ISSN TEXT NOT NULL,
  PubDate DATE NOT NULL,
  Volume TEXT NOT NULL,
  Issue TEXT NOT NULL,
  ISSNType TEXT NOT NULL,
  Title TEXT NOT NULL,
  PRIMARY KEY (JID)
)
```

```{sql connection=dbcon}
DROP TABLE IF EXISTS Author
```

```{sql connection=dbcon}
CREATE TABLE Author(
  AuthorId Integer NOT NULL,
  LastName TEXT NOT NULL,
  FirstName TEXT NOT NULL,
  Initials TEXT NOT NULL,
  Affiliation TEXT NOT NULL,
  PRIMARY KEY (AuthorId)
)
```

```{sql connection=dbcon}
DROP TABLE IF EXISTS History
```

```{sql connection=dbcon}
CREATE TABLE History(
  HistoryId Integer NOT NULL,
  received DATE,
  accepted DATE,
  entrez DATE NOT NULL,
  PRIMARY KEY (HistoryId)
)
```

```{sql connection=dbcon}
DROP TABLE IF EXISTS Article
```

```{sql connection=dbcon}
CREATE TABLE Article(
  PMID Integer NOT NULL,
  ArticleTitle TEXT NOT NULL,
  DateCreated DATE NOT NULL,
  JID Integer NOT NULL,
  HistoryId Integer NOT NULL,
  PRIMARY KEY (PMID),
  FOREIGN KEY (JID) REFERENCES Journal(JID),
  FOREIGN KEY (HistoryId) REFERENCES History(HistoryId)
)
```

```{sql connection=dbcon}
DROP TABLE IF EXISTS Write
```

```{sql connection=dbcon}
CREATE TABLE Write(
  PMID Integer NOT NULL,
  AuthorId Integer NOT NULL,
  PRIMARY KEY (PMID, AuthorId),
  FOREIGN KEY (AuthorId) REFERENCES Author(AuthorId), 
  FOREIGN KEY (PMID) REFERENCES Article(PMID)
)
```

## Part1 Question3
## Load the XML file
```{r}
library("XML")
library("methods")

path <- "/Users/zhaoyizhuang/5200/Practicum2/"
xmlFile <- "pubmed_sample.xml"
fp <- paste0(path,xmlFile)

xmlObj <- xmlParse(fp)
root <- xmlRoot(xmlObj)
size <- xmlSize(root)
```

## Self-defined function helping read the xml
```{r}
readFromXml <- function(xpathEx) {
  result <- xpathSApply(xmlObj, xpathEx, xmlValue)
}

```

## Create and Populate Journal table and add JID to Article. Note: The PubDate is depends on the subtag of the <PubDate> tag in the xml file. The PubDate in the database will be the 'pubmed' date when the subtag is <Year>, and 'medline' date when the subtag is <MedlineDate>
```{r}
ISSN <- readFromXml("//Article/Journal/ISSN")
Title <- readFromXml("//Article/Journal/Title")
Volume <- readFromXml("//Article/Journal/JournalIssue/Volume")
Issue <- readFromXml("//Article/Journal/JournalIssue/Issue")
JID <- 1:size
PubDate <- vector()
ISSNType <- xpathSApply(xmlObj, "//ISSN", xmlAttrs)
ISSNType <- as.character(ISSNType)

for (i in 1:size) {
  curr <- root[[i]][[2]][[1]]
  isMed <- TRUE
  for (e in 1:xmlSize(root[[i]][[1]])) {
    if (xmlName(root[[i]][[1]][[e]]) == "Article") {
        currr <- root[[i]][[1]][[e]][[1]][[2]][[3]][[1]]
        if (xmlName(currr) == "Year") {
          isMed <- FALSE
        }
      }
  }
  for (e in 1:xmlSize(curr)) {
    a <- xmlAttrs(curr[[e]])[[1]]
    if (a == "medline" & isMed) {
      PubDate <- append(PubDate, (paste(xmlValue(curr[[e]][[2]]), xmlValue(curr[[e]][[3]]), xmlValue(curr[[e]][[1]]), sep = "/")))
    }
    if (a == "pubmed" & !(isMed)) {
      PubDate <- append(PubDate, (paste(xmlValue(curr[[e]][[2]]), xmlValue(curr[[e]][[3]]), xmlValue(curr[[e]][[1]]), sep = "/")))
    }
  }
}


Journal <- cbind(JID, ISSN, PubDate, Volume, Issue, ISSNType, Title)
Journal <- data.frame(Journal)
Journal
```


## Create and Populate Author table. 
```{r}
Affiliation <- vector()
LastName <- vector()
FirstName <- vector()
Initials <- vector()
for (i in 1:size) {
  for (e in 1:xmlSize(root[[i]][[1]])) {
    if (xmlName(root[[i]][[1]][[e]]) == "Article") {
      for (s in 1:xmlSize(root[[i]][[1]][[e]])) {
        if (xmlName(root[[i]][[1]][[e]][[s]]) == "AuthorList") {
          curr <- root[[i]][[1]][[e]][[s]]
          for (f in 1:xmlSize(curr)) {
            LastName <- append(LastName, xmlValue(curr[[f]][[1]]))
            FirstName <- append(FirstName, xmlValue(curr[[f]][[2]]))
            Initials <- append(Initials, xmlValue(curr[[f]][[3]]))
            cc <- xmlValue(curr[[f]][[4]])
            if (is.na(cc)) {
              cc <- "None"
            }
            Affiliation <- append(Affiliation, cc)
          }
        }
      }
    }
  }
}
Author <- cbind(LastName, FirstName, Initials, Affiliation)
Author <- Author[!duplicated(Author), ]
AuthorId = 1:nrow(Author)
Author <- cbind(AuthorId, Author)
Author <- data.frame(Author)
Author
```

## Create and Populate the History table.
```{r}
received <- vector()
accepted <- vector()
entrez <- vector()
#medline <- vector()

#Year <- vector()
#Month <- vector()
#Day <- vector()

for (i in 1:size) {
  curr <- root[[i]][[2]][[1]]
  hasR <- FALSE
  hasA <- FALSE
  for (e in 1:xmlSize(curr)) {
    a <- xmlAttrs(curr[[e]])[[1]]
    if (a == "entrez") {
      entrez <- append(entrez, (paste(xmlValue(curr[[e]][[2]]), xmlValue(curr[[e]][[3]]), xmlValue(curr[[e]][[1]]), sep = "/")))
    } 
    if (a == "received") {
      received <- append(received, (paste(xmlValue(curr[[e]][[2]]), xmlValue(curr[[e]][[3]]), xmlValue(curr[[e]][[1]]), sep = "/")))
      hasR <- TRUE
    }
    if (a == "accepted") {
      accepted <- append(accepted, (paste(xmlValue(curr[[e]][[2]]), xmlValue(curr[[e]][[3]]), xmlValue(curr[[e]][[1]]), sep = "/")))
      hasA <- TRUE
    }
    #if (a == "pubmed") {
    #  Year <- append(Year, xmlValue(curr[[e]][[1]]))
    #  Month <- append(Month, xmlValue(curr[[e]][[2]]))
    #  Day <- append(Day, xmlValue(curr[[e]][[3]]))
    #}
    #if (a == "medline") {
    #  medline <- append(medline, (paste(xmlValue(curr[[e]][[2]]), xmlValue(curr[[e]][[3]]), xmlValue(curr[[e]][[1]]), sep = "/")))
    #}
  }
  if (!(hasR)) {
    received <- append(received, NA)
  }
  if (!(hasA)) {
    accepted <- append(accepted, NA)
  }
}

History <- cbind(received, accepted, entrez)
History <- History[!duplicated(History), ]

HistoryId = 1:nrow(History)

History <- cbind(HistoryId, History)
History <- data.frame(History)
#History$received <- as.Date(History$received, format = "%m/%d/%Y")
#History$accepted <- as.Date(History$accepted, format = "%m/%d/%Y")
#History$entrez <- as.Date(History$entrez, format = "%m/%d/%Y")
#History$medline <- as.Date(History$medline, format = "%m/%d/%Y")
History
```

## Create and Populate the Article table. 
```{r}
PMID <- readFromXml("//MedlineCitation/PMID")
ArticleTitle <- readFromXml("//ArticleTitle")
DateCreated <- vector()

for (i in 1:size) {
  curr <- root[[i]][[1]][[2]]
  date <- paste(xmlValue(curr[[2]]), xmlValue(curr[[3]]), xmlValue(curr[[1]]), sep = "/")
  DateCreated <- append(DateCreated, date)
}

Article <- cbind(PMID, JID, HistoryId, DateCreated, ArticleTitle)
Article <- data.frame(Article)
#Article$DateCreated <- as.Date(Article$DateCreated, format = "%m/%d/%Y")
#Article$PubDate <- as.Date(Article$PubDate, format = "%m/%d/%Y")
Article
```

## Create Write table, it is a look up table represents the relationship between author and article.
```{r}
AuthorList_Id <- vector()
AuthorList_AuthorId <- vector()
Author_count <- 1
ff <- vector()
gg <- vector()

for (i in 1:size) {
  pid <- xmlValue(root[[i]][[1]][[1]])
  for (e in 1:xmlSize(root[[i]][[1]])) {
    if (xmlName(root[[i]][[1]][[e]]) == "Article")
      for (s in 1:xmlSize(root[[i]][[1]][[e]])) {
        if (xmlName(root[[i]][[1]][[e]][[s]]) == "AuthorList") {
          curr <- root[[i]][[1]][[e]][[s]]
          for (f in 1:xmlSize(curr)) {
            LastName <- xmlValue(curr[[f]][[1]])
            FirstName <- xmlValue(curr[[f]][[2]])
            Initials <- xmlValue(curr[[f]][[3]])
            Affiliation <- xmlValue(curr[[f]][[4]])
            if (is.na(Affiliation)) {
              Affiliation <- "None"
            }
            
            for(v in 1 : nrow(Author)) {
              if (LastName == Author$LastName[v] & FirstName == Author$FirstName[v] 
                  & Initials == Author$Initials[v] & Affiliation == Author$Affiliation[v]) {
                
                AuthorList_Id <- append(AuthorList_Id, Author_count)
                AuthorList_AuthorId <- append(AuthorList_AuthorId, as.character(Author$AuthorId[v]))
                ff <- append(ff, as.character(Author$AuthorId[v]))
                gg <- append(gg, pid)
                break;
              }
            }
          }
        }
      }
    }
  Author_count <- Author_count + 1
}

Write <- cbind(ff, gg)
Write <- data.frame(Write)
names(Write) <- c("AuthorId", "PMID")
Write
```


## Write table to the database
```{r}
dbWriteTable(conn = dbcon, 
             name = "Journal", 
             value = Journal,
             overwrite = T)

dbWriteTable(conn = dbcon, 
             name = "Author", 
             value = Author,
             overwrite = T)

dbWriteTable(conn = dbcon, 
             name = "History", 
             value = History,
             overwrite = T)

dbWriteTable(conn = dbcon, 
             name = "Article", 
             value = Article,
             overwrite = T)

dbWriteTable(conn = dbcon, 
             name = "Write", 
             value = Write,
             overwrite = T)
```

## Show tables
```{sql connection=dbcon}
SELECT * FROM Journal
```

```{sql connection=dbcon}
SELECT * FROM Author
```

```{sql connection=dbcon}
SELECT * FROM History
```

```{sql connection=dbcon}
SELECT * FROM Article
```

```{sql connection=dbcon}
SELECT * FROM Write
```

# Part2
## Part2 Question1
![](/Users/zhaoyizhuang/5200/Practicum2/P2Q1.png)
```{sql connection=dbcon}
DROP TABLE IF EXISTS Journal_Dimension
```

```{sql connection=dbcon}
CREATE TABLE Journal_Dimension(
  JID Integer NOT NULL,
  ISSN TEXT NOT NULL,
  PubDate DATE NOT NULL,
  Volume Integer NOT NULL,
  Issue Integer NOT NULL,
  ISSNType TEXT NOT NULL,
  Title TEXT NOT NULL,
  PRIMARY KEY (JID)
)
```

```{sql connection=dbcon}
DROP TABLE IF EXISTS Author_Dimension
```

```{sql connection=dbcon}
CREATE TABLE Author_Dimension(
  AuthorId Integer NOT NULL,
  LastName TEXT NOT NULL,
  FirstName TEXT NOT NULL,
  Initials TEXT NOT NULL,
  Affiliation TEXT NOT NULL,
  PRIMARY KEY (AuthorId)
)
```

```{sql connection=dbcon}
DROP TABLE IF EXISTS History_Dimension
```

```{sql connection=dbcon}
CREATE TABLE History_Dimension(
  HistoryId Integer NOT NULL,
  received DATE,
  accepted DATE,
  entrez DATE NOT NULL,
  medline DATE NOT NULL,
  PRIMARY KEY (HistoryId)
)
```

```{sql connection=dbcon}
DROP TABLE IF EXISTS Article_Fact
```

```{sql connection=dbcon}
CREATE TABLE Article_Fact(
  PMID Integer NOT NULL,
  ArticleTitle TEXT NOT NULL,
  DateCreated DATE NOT NULL,
  AuthorListId Integer NOT NULL,
  JID TEXT NOT NULL,
  HistoryId TEXT NOT NULL,
  PRIMARY KEY (PMID),
  FOREIGN KEY (AuthorListId) REFERENCES AuthorList_Dimension(AuthorListId),
  FOREIGN KEY (JID) REFERENCES Journal_Dimension(JID),
  FOREIGN KEY (HistoryId) REFERENCES History_Dimension(HistoryId)
)
```

```{sql connection=dbcon}
DROP TABLE IF EXISTS AuthorList_Dimension
```

```{sql connection=dbcon}
CREATE TABLE AuthorList_Dimension(
  AuthorListId TEXT NOT NULL,
  PRIMARY KEY (AuthorListId)
)
```

```{sql connection=dbcon}
DROP TABLE IF EXISTS AuthorList_Bridge
```

```{sql connection=dbcon}
CREATE TABLE AuthorList_Bridge(
  AuthorListId TEXT NOT NULL,
  AuthorId TEXT NOT NULL,
  PRIMARY KEY (AuthorListId, AuthorId),
  FOREIGN KEY (AuthorId) REFERENCES Author_Dimension(AuthorId), 
  FOREIGN KEY (AuthorListId) REFERENCES AuthorList_Dimension(AuthorListId)
)
```

## Populate the AuthorList_Dimension
```{r}
AuthorList_Dimension = 1:size
```

## Add AuthorListId to the Article_Fact
```{r}
Article_Fact <- cbind(Article, AuthorList_Dimension)
Article_Fact
```

## Populate the AuthorList_Bridge
```{r}
AuthorList_Bridge <- cbind(AuthorList_Id, AuthorList_AuthorId)
AuthorList_Bridge <- data.frame(AuthorList_Bridge)
AuthorList_Bridge
```

## Overwrite tables to database
```{r}
dbWriteTable(conn = dbcon, 
             name = "Journal_Dimension", 
             value = Journal,
             overwrite = T)

dbWriteTable(conn = dbcon, 
             name = "Author_Dimension", 
             value = Author,
             overwrite = T)

dbWriteTable(conn = dbcon, 
             name = "History_Dimension", 
             value = History,
             overwrite = T)

dbWriteTable(conn = dbcon, 
             name = "Article_Fact", 
             value = Article_Fact,
             overwrite = T)

dbWriteTable(conn = dbcon, 
             name = "AuthorList_Bridge", 
             value = AuthorList_Bridge,
             overwrite = T)

dbWriteTable(conn = dbcon, 
             name = "AuthorList_Dimension", 
             value = data.frame(AuthorList_Dimension),
             overwrite = T)
```

## Show tables
```{sql connection=dbcon}
SELECT * FROM History_Dimension
```

```{sql connection=dbcon}
SELECT * FROM Journal_Dimension
```

```{sql connection=dbcon}
SELECT * FROM AuthorList_Dimension
```

```{sql connection=dbcon}
SELECT * FROM AuthorList_Bridge
```

```{sql connection=dbcon}
SELECT * FROM Author_Dimension
```

```{sql connection=dbcon}
SELECT * FROM Article_Fact
```

## Part2 Question2
![](/Users/zhaoyizhuang/5200/Practicum2/P2Q2.png)
```{sql connection=dbcon}
DROP TABLE IF EXISTS Journal_Summary_Fact
```

```{sql connection=dbcon}
CREATE TABLE Journal_Summary_Fact(
  JounalSummaryId TEXT NOT NULL,
  ISSN TEXT NOT NULL,
  ArticleNumber Integer NOT NULL,
  Quarter TEXT NOT NULL,
  Year TEXT NOT NULL,
  PRIMARY KEY (JounalSummaryId),
  FOREIGN KEY (ISSN) REFERENCES Jounal_Dimension(ISSN)
)
```

```{sql connection=dbcon}
DROP TABLE IF EXISTS Author_Summary_Fact
```

```{sql connection=dbcon}
CREATE TABLE Author_Summary_Fact(
  AuthorSummaryId TEXT NOT NULL,
  AuthorId TEXT NOT NULL,
  ArticleNumber Integer NOT NULL,
  Quarter TEXT NOT NULL,
  Year TEXT NOT NULL,
  PRIMARY KEY (AuthorSummaryId),
  FOREIGN KEY (AuthorId) REFERENCES Author_Dimension(AuthorId)
)
```

## Populate the Journal_Summary_Fact table
```{r}
ISSN <- vector()
Quarter  <- vector()
Year <- vector()
for (i in 1:size) {
  for (e in 1:xmlSize(root[[i]][[1]])) {
    if (xmlName(root[[i]][[1]][[e]]) == "Article") {
      ISSN <- append(ISSN, xmlValue(root[[i]][[1]][[e]][[1]][[1]]))
    }
  }
  for (e in 1:xmlSize(root[[i]][[2]][[1]])) {
    if (xmlName(root[[i]][[2]][[1]][[e]]) == "PubMedPubDate") {
      if (as.character(xmlAttrs(root[[i]][[2]][[1]][[e]])) == "pubmed") {
        curr <- root[[i]][[2]][[1]][[e]]
        m <- as.numeric(xmlValue(curr[[2]]))
        Year <- append(Year, xmlValue(curr[[1]]))
        if (m < 4) {
          Quarter  <- append(Quarter, 1);
        }
        if (m > 3 & m < 7) {
          Quarter  <- append(Quarter, 2);
        }
        if (m > 6 & m < 10) {
          Quarter  <- append(Quarter, 3);
        }
        if (m > 9) {
          Quarter  <- append(Quarter, 4);
        }
      }
    }
  }
}

temp <- cbind(JID, ISSN, Volume, Issue, Quarter, Year)
temp <- data.frame(temp)

ArticlesThisYear <- vector()
ArticlesThisQuarter <- vector()

for (i in 1:nrow(temp)) {
  anum <- 0
  qnum <- 0
  for (j in 1:nrow(temp)) {
    if (temp$ISSN[i] == temp$ISSN[j] & temp$Year[i] == temp$Year[j]) {
      anum <- anum + 1
    }
    if (temp$ISSN[i] == temp$ISSN[j] & temp$Quarter[i] == temp$Quarter[j] & temp$Year[i] == temp$Year[j]) {
      qnum <- qnum + 1
    }
  }
  ArticlesThisYear <- append(ArticlesThisYear, anum)
  ArticlesThisQuarter <- append(ArticlesThisQuarter, qnum)
}
JournalSummaryId <- 1:nrow(temp)
temp <- cbind(JournalSummaryId, Title, temp, ArticlesThisYear, ArticlesThisQuarter)
Journal_Summary_Fact <- temp[!duplicated(temp), ]
Journal_Summary_Fact
```

## Populate the Author_Summary_Fact table. Note: this chunk will take a while to run because it does a lot of calculation.
```{r}
Affiliation <- vector()
LastName <- vector()
FirstName <- vector()
Initials <- vector()
Quarter  <- vector()
Year <- vector()
for (i in 1:size) {
  for (e in 1:xmlSize(root[[i]][[1]])) {
    if (xmlName(root[[i]][[1]][[e]]) == "Article")
      for (s in 1:xmlSize(root[[i]][[1]][[e]])) {
        if (xmlName(root[[i]][[1]][[e]][[s]]) == "AuthorList") {
          curr <- root[[i]][[1]][[e]][[s]]
          for (f in 1:xmlSize(curr)) {
            
              for (ee in 1:xmlSize(root[[i]][[2]][[1]])) {
                if (xmlName(root[[i]][[2]][[1]][[ee]]) == "PubMedPubDate") {
                  if (as.character(xmlAttrs(root[[i]][[2]][[1]][[ee]])) == "pubmed") {
                    currrr <- root[[i]][[2]][[1]][[ee]]
                    m <- as.numeric(xmlValue(currrr[[2]]))
                    if (m < 4) {
                      Quarter  <- append(Quarter, 1);
                    }
                    if (m > 3 & m < 7) {
                      Quarter  <- append(Quarter, 2);
                    }
                    if (m > 6 & m < 10) {
                      Quarter  <- append(Quarter, 3);
                    }
                    if (m > 9) {
                      Quarter  <- append(Quarter, 4);
                    }
                    Year <- append(Year, xmlValue(currrr[[1]]))
                  }
                }
              }
            
            LastName <- append(LastName, xmlValue(curr[[f]][[1]]))
            FirstName <- append(FirstName, xmlValue(curr[[f]][[2]]))
            Initials <- append(Initials, xmlValue(curr[[f]][[3]]))
            cc <- xmlValue(curr[[f]][[4]])
            if (is.na(cc)) {
              cc <- "None"
            }
            Affiliation <- append(Affiliation, cc)
          }
        }
      }
  }
}
temp <- cbind(LastName, FirstName, Initials, Affiliation, Quarter, Year)
temp <- data.frame(temp)

ArticlesThisYear <- vector()
ArticlesThisQuarter <- vector()

for (i in 1:nrow(temp)) {
  anum <- 0
  qnum <- 0
  for (j in 1:nrow(temp)) {
    if (temp$LastName[i] == temp$LastName[j] & temp$FirstName[i] == temp$FirstName[j]
        & temp$Initials[i] == temp$Initials[j] & temp$Affiliation[i] == temp$Affiliation[j] 
        & temp$Year[i] == temp$Year[j]) {
      anum <- anum + 1
    }
    if (temp$LastName[i] == temp$LastName[j] & temp$FirstName[i] == temp$FirstName[j]
        & temp$Initials[i] == temp$Initials[j] & temp$Affiliation[i] == temp$Affiliation[j] 
        & temp$Year[i] == temp$Year[j] & temp$Quarter[i] == temp$Quarter[j]) {
      qnum <- qnum + 1
    }
  }
  ArticlesThisYear <- append(ArticlesThisYear, anum)
  ArticlesThisQuarter <- append(ArticlesThisQuarter, qnum)
}

temp <- cbind(temp, ArticlesThisYear, ArticlesThisQuarter)
Author_Summary_Fact <- temp[!duplicated(temp), ]
AuthorSummaryId <- 1:nrow(Author_Summary_Fact)
Author_Summary_Fact <- cbind(Author_Summary_Fact, AuthorSummaryId)
Author_Summary_Fact
```

## Add AuthorId to the corresponding row.
```{r}
AuthorId <- vector()
for (i in 1:nrow(Author_Summary_Fact)) {
  for (j in 1:nrow(Author)) {
    if (Author$LastName[j] == Author_Summary_Fact$LastName[i] & Author$FirstName[j] == Author_Summary_Fact$FirstName[i] & 
        Author$Initials[j] == Author_Summary_Fact$Initials[i] & Author$Affiliation[j] == Author_Summary_Fact$Affiliation[i]) {
      AuthorId <- append(AuthorId, as.character(Author$AuthorId[j]))
      break;
        }
  }
}
Author_Summary_Fact <- cbind(AuthorId, Author_Summary_Fact)
Author_Summary_Fact
```

## Overwrite tables to database
```{r}
dbWriteTable(conn = dbcon, 
             name = "Journal_Summary_Fact", 
             value = Journal_Summary_Fact,
             overwrite = T)

dbWriteTable(conn = dbcon, 
             name = "Author_Summary_Fact", 
             value = Author_Summary_Fact,
             overwrite = T)
```

## Show tables
```{sql connection=dbcon}
SELECT * FROM Author_Summary_Fact
```

```{sql connection=dbcon}
SELECT * FROM Journal_Summary_Fact
```

# Part3
## Part3
## Number of publications for all journals each quarter
```{r}
library(dplyr, warn.conflicts = FALSE)
library(ggplot2)
Qinfo <- paste(Journal_Summary_Fact$Quarter, Journal_Summary_Fact$Year, sep = "stQuarter")
perYear <- aggregate(Journal_Summary_Fact$ArticlesThisQuarter, list(Qinfo), sum)
colnames(perYear) <- c("Year", "ArticleNumber")
perYear
```


```{r}
dbDisconnect(dbcon)
```
